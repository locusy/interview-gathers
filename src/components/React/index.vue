<template>
    <div>
      <p>1ã€vueå’Œreactçš„åŒºåˆ«ï¼Ÿ</p>
      <p>2ã€reactæ€§èƒ½ä¼˜åŒ–ç‚¹æœ‰å“ªäº›ï¼Ÿ</p>
      <p>3ã€è¯´ä¸‹Reactçš„ç”Ÿå‘½å‘¨æœŸ</p>
      <p>4ã€reactå“ªäº›ç”Ÿå‘½å‘¨æœŸåªæ‰§è¡Œä¸€æ¬¡</p>
      <p>5ã€å“ªäº›åœ°æ–¹è°ƒç”¨setState</p>
      <p>6ã€reactå‡½æ•°æ”¹å˜thisæŒ‡å‘çš„æ–¹å¼</p>
      <p>7ã€è°ƒç”¨setStateä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
      <p>8ã€Reactä¸­keyçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <p>9ã€ä¸ºä»€ä¹ˆè™šæ‹Ÿdomä¼šæé«˜æ€§èƒ½?(å¿…è€ƒ)</p>
      <p>10ã€react diff åŸç†ï¼ˆå¸¸è€ƒï¼Œå¤§å‚å¿…è€ƒï¼‰</p>
      <p>11ã€è·¯ç”±ä¼ å‚æ–¹å¼ï¼š</p>
      <p>12ã€æ‰‹åŠ¨å®ç°thisçš„ç»‘å®šçš„æ–¹æ³•ï¼š</p>
      <p>13ã€ç»„ä»¶é—´çš„é€šä¿¡æ–¹æ³•ï¼š</p>
      <p>14ã€this.setStateå‡½æ•°æœ‰ä¸‰ç§ç”¨æ³•ï¼š</p>
      <p>15ã€setStateä¸ºä»€ä¹ˆæ˜¯å¼‚æ­¥çš„</p>
      <p>16ã€setStateå˜æˆåŒæ­¥</p>
      <p>17ã€é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºï¼š</p>
      <p>18ã€å‰ç«¯ä¸è¦æ“ä½œcookie</p>
      <p>19ã€é˜²æ­¢xssæ”»å‡»</p>
      <p>20ã€åœ¨ç»„ä»¶ä¸­è·å–çœŸå®dom</p>
      <p>21ã€å®¹å™¨å‹ç»„ä»¶å’Œå±•ç¤ºå‹ç»„ä»¶</p>
      <p>22ã€creat-react-appè®¾ç½®ä»£ç†ï¼Ÿ</p>
      <p>23ã€æƒé™æ§åˆ¶ï¼š</p>
      <p>24ã€é«˜é˜¶ç»„ä»¶ï¼š</p>
      <p>25ã€ä¸ºä»€ä¹ˆè¦å¼•å…¥React</p>
      <p>26ã€ä¸ºä»€ä¹ˆè¦ç”¨classNameè€Œä¸ç”¨class</p>
      <p>27ã€ä¸ºä»€ä¹ˆå±æ€§è¦ç”¨å°é©¼å³°</p>
      <p>28ã€ä¸ºä»€ä¹ˆ constructor é‡Œè¦è°ƒç”¨ super å’Œä¼ é€’ props</p>
      <p>29ã€ä¸ºä»€ä¹ˆç»„ä»¶ç”¨å¤§å†™å¼€å¤´</p>
      <p>30ã€ä¸ºä»€ä¹ˆè°ƒç”¨æ–¹æ³•è¦ bind this</p>
      <p>31ã€ä¸ºä»€ä¹ˆè¦ setStateï¼Œè€Œä¸æ˜¯ç›´æ¥ this.state.xx = oo</p>
      <p>32ã€setStateæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ç›¸å…³é—®é¢˜</p>
      <p>33ã€é‡æ„ä»£ç éœ€è¦è€ƒè™‘çš„é—®é¢˜æœ‰å“ªäº›ï¼Ÿ</p>
      <p>34ã€çˆ¶ç»„ä»¶æ€ä¹ˆè·å–å­ç»„ä»¶çš„æ–¹æ³•</p>
      <p>35ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨redux+immutableï¼Œreduxå’Œå…¨å±€å˜é‡çš„åŒºåˆ«</p>
      <p>36ã€react-reduxçš„å·¥ä½œåŸç†å’Œç›¸å…³æºç </p>
      <p>37ã€setStateçš„æ‰¹é‡æ›´æ–°çš„é—®é¢˜</p>
      <p>38ã€å‰ç«¯ç›‘æ§sentry</p>
      <p>39ã€åˆ©ç”¨useMemoå®ç°ç±»ä¼¼computedçš„åŠŸèƒ½</p>
      <p>
        é¢è¯•é¢˜åˆé›†ï¼š
        <a href="https://segmentfault.com/a/1190000016885832" target="_blank">
          https://segmentfault.com/a/1190000016885832
        </a>
        <br />
        <a href="https://mp.weixin.qq.com/s/I10nJpMGT2N-SBkHPES_TA" target="_blank">
          https://mp.weixin.qq.com/s/I10nJpMGT2N-SBkHPES_TA
        </a>
      </p>
    </div>
</template>

<script>
/*
  1ã€vueå’Œreactçš„åŒºåˆ«ï¼Ÿ
    Reactç”Ÿå‘½å‘¨æœŸå’Œvueçš„åŒºåˆ«
    Reduxå’ŒvuexåŒºåˆ«
    reactå’Œvueæ•°æ®åŒå‘ç»‘å®šåŒºåˆ«

  2ã€reactæ€§èƒ½ä¼˜åŒ–ç‚¹æœ‰å“ªäº›ï¼Ÿ
    reactåœ¨æ¯ä¸ªç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ›´æ–°çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨ä¸€ä¸ªshouldComponentUpdate(nextProps, nextState)å‡½æ•°ã€‚
    å®ƒçš„èŒè´£å°±æ˜¯è¿”å›trueæˆ–falseï¼Œtrueè¡¨ç¤ºéœ€è¦æ›´æ–°ï¼Œfalseè¡¨ç¤ºä¸éœ€è¦ï¼Œé»˜è®¤è¿”å›ä¸ºtrueï¼Œ
    å³ä¾¿ä½ æ²¡æœ‰æ˜¾ç¤ºåœ°å®šä¹‰ shouldComponentUpdate å‡½æ•°ã€‚
    è¿™å°±ä¸éš¾è§£é‡Šä¸Šé¢å‘ç”Ÿçš„èµ„æºæµªè´¹äº†ã€‚

  3ã€è¯´ä¸‹Reactçš„ç”Ÿå‘½å‘¨æœŸ
    å®ä¾‹åŒ–
    getDefaultProps
    getInitialState
    constructor
    componentWillMount
    render
    componentDidMount
    å­˜åœ¨æœŸ
    componentWillReceiveProps
    shouldComponentUpdate
    componentWillUpdate
    render
    componentDidUpdate
    é”€æ¯æ—¶
    componentWillUnmountï¼šæ‰§è¡Œä¸€äº›æ¸…ç†æ–¹æ³•ï¼Œå¦‚äº‹ä»¶å›æ”¶æˆ–æ˜¯æ¸…é™¤å®šæ—¶å™¨ã€‚

  4ã€reactå“ªäº›ç”Ÿå‘½å‘¨æœŸåªæ‰§è¡Œä¸€æ¬¡
    getDefaultProps
    getInitialState
    componentWillMount
    componentDidMount
    componentWillUnmount

  5ã€å“ªäº›åœ°æ–¹è°ƒç”¨setState
    å¦‚æœåœ¨ componentWillMount ä¸­æ‰§è¡Œ setState æ–¹æ³•ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?ç»„ä»¶ä¼šæ›´æ–° stateï¼Œ ä½†ç»„ä»¶åªæ¸²æŸ“ä¸€æ¬¡ã€‚
    å› æ­¤ï¼Œè¿™æ˜¯æ— æ„ä¹‰çš„æ‰§è¡Œï¼Œåˆå§‹åŒ–æ—¶çš„ state éƒ½å¯ä»¥æ”¾åœ¨ this.stateã€‚

    å¦‚æœæˆ‘ä»¬åœ¨ componentDidMount ä¸­æ‰§è¡Œ setState æ–¹æ³•ï¼Œåˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?ç»„ä»¶å½“ç„¶ä¼šå†æ¬¡æ›´ æ–°ï¼Œ
    ä¸è¿‡åœ¨åˆå§‹åŒ–è¿‡ç¨‹å°±æ¸²æŸ“äº†ä¸¤æ¬¡ç»„ä»¶ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä»¶å¥½äº‹ã€‚ä½†å®é™…æƒ…å†µæ˜¯ï¼Œæœ‰ä¸€äº›åœºæ™¯ä¸å¾— ä¸éœ€è¦ setStateï¼Œ
    æ¯”å¦‚è®¡ç®—ç»„ä»¶çš„ä½ç½®æˆ–å®½é«˜æ—¶ï¼Œå°±ä¸å¾—ä¸è®©ç»„ä»¶å…ˆæ¸²æŸ“ï¼Œæ›´æ–°å¿…è¦çš„ä¿¡æ¯åï¼Œ å†æ¬¡æ¸²æŸ“ã€‚
    new Promise((resolve) => {
      this.setState({ pageNumber });
      resolve()
    }).then(() => this.getSubjectLibList())

  6ã€reactå‡½æ•°æ”¹å˜thisæŒ‡å‘çš„æ–¹å¼
    bind
    ç®­å¤´å‡½æ•°

  7ã€è°ƒç”¨setStateä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
    åœ¨ä»£ç ä¸­è°ƒç”¨ setState å‡½æ•°ä¹‹åï¼ŒReact ä¼šå°†ä¼ å…¥çš„å‚æ•°å¯¹è±¡ä¸ç»„ä»¶å½“å‰çš„çŠ¶æ€åˆå¹¶ï¼Œç„¶åè§¦å‘æ‰€è°“çš„è°ƒå’Œè¿‡ç¨‹ï¼ˆReconciliationï¼‰ã€‚
    ç»è¿‡è°ƒå’Œè¿‡ç¨‹ï¼ŒReact ä¼šä»¥ç›¸å¯¹é«˜æ•ˆçš„æ–¹å¼æ ¹æ®æ–°çš„çŠ¶æ€æ„å»º React å…ƒç´ æ ‘å¹¶ä¸”ç€æ‰‹é‡æ–°æ¸²æŸ“æ•´ä¸ª UI ç•Œé¢ã€‚
    åœ¨ React å¾—åˆ°å…ƒç´ æ ‘ä¹‹åï¼ŒReact ä¼šè‡ªåŠ¨è®¡ç®—å‡ºæ–°çš„æ ‘ä¸è€æ ‘çš„èŠ‚ç‚¹å·®å¼‚ï¼Œç„¶åæ ¹æ®å·®å¼‚å¯¹ç•Œé¢è¿›è¡Œæœ€å°åŒ–é‡æ¸²æŸ“ã€‚
    åœ¨å·®å¼‚è®¡ç®—ç®—æ³•ä¸­ï¼ŒReact èƒ½å¤Ÿç›¸å¯¹ç²¾ç¡®åœ°çŸ¥é“å“ªäº›ä½ç½®å‘ç”Ÿäº†æ”¹å˜ä»¥åŠåº”è¯¥å¦‚ä½•æ”¹å˜ï¼Œè¿™å°±ä¿è¯äº†æŒ‰éœ€æ›´æ–°ï¼Œè€Œä¸æ˜¯å…¨éƒ¨é‡æ–°æ¸²æŸ“ã€‚

  8ã€Reactä¸­keyçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå­—èŠ‚ï¼‰
    Keyæ˜¯Reactç”¨äºè¿½è¸ªå“ªäº›åˆ—è¡¨ä¸­å…ƒç´ è¢«ä¿®æ”¹ã€è¢«æ·»åŠ æˆ–è€…è¢«ç§»é™¤çš„è¾…åŠ©æ ‡è¯†
    render () {
      return (
        <ul>
          {this.state.todoItems.map(({item, key}) => {
            return <li key={key}>{item}</li>
          })}
        </ul>
      )
    }
    åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯æŸä¸ªå…ƒç´ çš„keyåœ¨å…¶åŒçº§å…ƒç´ ä¸­å…·æœ‰å”¯ä¸€æ€§ã€‚
    åœ¨React Diffç®—æ³•ä¸­Reactä¼šå€ŸåŠ©å…ƒç´ çš„Keyå€¼æ¥åˆ¤æ–­è¯¥å…ƒç´ æ˜¯æ–°è¿‘åˆ›å»ºçš„è¿˜æ˜¯è¢«ç§»åŠ¨è€Œæ¥çš„å…ƒç´ ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„å…ƒç´ é‡æ¸²æŸ“ã€‚
    æ­¤å¤–ï¼ŒReactè¿˜éœ€è¦å€ŸåŠ©Keyå€¼æ¥åˆ¤æ–­å…ƒç´ ä¸æœ¬åœ°çŠ¶æ€çš„å…³è”å…³ç³»ï¼Œå› æ­¤æˆ‘ä»¬ç»ä¸å¯å¿½è§†è½¬æ¢å‡½æ•°ä¸­Keyçš„é‡è¦æ€§ã€‚

  9ã€ä¸ºä»€ä¹ˆè™šæ‹Ÿdomä¼šæé«˜æ€§èƒ½?(å¿…è€ƒ)
    è™šæ‹Ÿ dom ç›¸å½“äºåœ¨ js å’ŒçœŸå® dom ä¸­é—´åŠ äº†ä¸€ä¸ªç¼“å­˜ï¼Œåˆ©ç”¨ dom diff ç®—æ³•é¿å…äº†æ²¡æœ‰å¿…è¦çš„ dom æ“ä½œï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚

    ç”¨JavaScriptå¯¹è±¡ç»“æ„è¡¨ç¤ºDOMæ ‘çš„ç»“æ„ï¼›
    ç„¶åç”¨è¿™ä¸ªæ ‘æ„å»ºä¸€ä¸ªçœŸæ­£çš„ DOM æ ‘ï¼Œæ’åˆ°æ–‡æ¡£å½“ä¸­å½“çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œé‡æ–°æ„é€ ä¸€æ£µæ–°çš„å¯¹è±¡æ ‘ã€‚
    ç„¶åç”¨æ–°çš„æ ‘å’Œæ—§çš„æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œè®°å½•ä¸¤æ£µæ ‘å·®å¼‚æŠŠ 2 æ‰€è®°å½•çš„å·®å¼‚åº”ç”¨åˆ°æ­¥éª¤ 1 æ‰€æ„å»ºçš„çœŸæ­£çš„DOMæ ‘ä¸Šï¼Œè§†å›¾å°±æ›´æ–°äº†ã€‚

  10ã€react diffåŸç†ï¼ˆå¸¸è€ƒï¼Œå¤§å‚å¿…è€ƒï¼‰
    æŠŠæ ‘å½¢ç»“æ„æŒ‰ç…§å±‚çº§åˆ†è§£ï¼Œåªæ¯”è¾ƒåŒçº§å…ƒç´ ã€‚
    ç»™åˆ—è¡¨ç»“æ„çš„æ¯ä¸ªå•å…ƒæ·»åŠ å”¯ä¸€çš„ key å±æ€§ï¼Œæ–¹ä¾¿æ¯”è¾ƒã€‚
    React åªä¼šåŒ¹é…ç›¸åŒ class çš„ componentï¼ˆè¿™é‡Œé¢çš„classæŒ‡çš„æ˜¯ç»„ä»¶çš„åå­—ï¼‰
    åˆå¹¶æ“ä½œï¼Œè°ƒç”¨ component çš„ setState æ–¹æ³•çš„æ—¶å€™, Reactå°†å…¶æ ‡è®°ä¸º dirty.
    åˆ°æ¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ç»“æŸ, Reactæ£€æŸ¥æ‰€æœ‰æ ‡è®°dirtyçš„componenté‡æ–°ç»˜åˆ¶.
    é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“ã€‚å¼€å‘äººå‘˜å¯ä»¥é‡å†™shouldComponentUpdateæé«˜diffçš„æ€§èƒ½ã€‚

  11ã€è·¯ç”±ä¼ å‚æ–¹å¼ï¼š
    params
    this.props.history.push({
      pathname: '/manage',
      params: {
        id: item.id
      }
    })

    queryï¼šåˆ·æ–°å°±æ²¡
    this.props.history.push({
      pathname: '/create' ,
      query: {
        type: 'edit',
        id: item.id
      }
    })

    stateï¼šåˆ·æ–°å°±æ²¡æœ‰äº†
    this.props.history.push({
      pathname: '/manage',
      state: {
        id: item.id
      }
    })

  12ã€æ‰‹åŠ¨å®ç°thisçš„ç»‘å®šçš„æ–¹æ³•ï¼š
     1ï¼‰bind æ–¹æ³•ï¼š
        è¿™ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»‘å®šäº‹ä»¶å¤„ç†å™¨å†…çš„ this ï¼Œå¹¶å¯ä»¥å‘äº‹ä»¶å¤„ç†å™¨ä¸­ä¼  5 é€’å‚æ•°ï¼Œæ¯”å¦‚:

        import React, { Component } from 'react';
        class App extends Component { 
          handleClick(e, arg) {
            console.log(e, arg); 
          }
          render() {
            // é€šè¿‡bindæ–¹æ³•å®ç°ï¼Œå¯ä»¥ä¼ é€’å‚æ•°
            return <button onClick={this.handleClick.bind(this, 'test')}>Test</button>;
          } 
        }

        å¦‚æœæ–¹æ³•åªç»‘å®šï¼Œä¸ä¼ å‚ï¼Œé‚£ stage 0 è‰æ¡ˆä¸­æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„æ–¹æ¡ˆ1â€”â€”åŒå†’å·è¯­æ³•ï¼Œå…¶ä½œ ç”¨ä¸ this.handleClick.bind(this) ä¸€è‡´ï¼Œå¹¶ä¸” Babel å·²ç»å®ç°äº†è¯¥ææ¡ˆã€‚æ¯”å¦‚:
        import React, { Component } from 'react';
        class App extends Component { 
          handleClick(e) {
            console.log(e); 
          }
          render() {
            return <button onClick={this.handleClick}>Test</button>;
          } 
        }

      2ï¼‰æ„é€ å™¨å†…å£°æ˜ï¼š
        åœ¨ç»„ä»¶çš„æ„é€ å™¨å†…å®Œæˆäº† this çš„ç»‘å®šï¼Œè¿™ç§ç»‘å®šæ–¹å¼çš„å¥½å¤„åœ¨äºä»…éœ€è¦ è¿›è¡Œä¸€æ¬¡ç»‘å®šï¼Œè€Œä¸éœ€è¦æ¯æ¬¡è°ƒç”¨äº‹ä»¶ç›‘å¬å™¨æ—¶å»æ‰§è¡Œç»‘å®šæ“ä½œ:
        import React, { Component } from 'react';
        class App extends Component {
          constructor(props) {
            super(props);
            this.handleClick = this.handleClick.bind(this); 
          }
          handleClick(e) { 
            console.log(e);
          }
          render() {
            return <button onClick={this.handleClick}>Test</button>;
          } 
        }

      3) ç®­å¤´å‡½æ•°ï¼š
        ç®­å¤´å‡½æ•°ä¸ä»…æ˜¯å‡½æ•°çš„â€œè¯­æ³•ç³–â€ï¼Œå®ƒè¿˜è‡ªåŠ¨ç»‘å®šäº†å®šä¹‰æ­¤å‡½æ•°ä½œç”¨åŸŸçš„ thisï¼Œ å› æ­¤æˆ‘ä»¬ä¸éœ€è¦å†å¯¹å®ƒä½¿ç”¨ bind æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œä»¥ä¸‹æ–¹å¼å°±èƒ½è¿è¡Œ:
        import React, { Component } from 'react';

        class App extends Component {
          const handleClick = (e) => {
            console.log(e);
          };

          render() {
            return <button onClick={this.handleClick}>Test</button>;
          } 
        }
        æˆ–
        import React, { Component } from 'react';
        class App extends Component {
          handleClick(e) {
            console.log(e); 
          }
          render() {
            return <button onClick={() => this.handleClick()}>Test</button> 
          }
        }

        ä½¿ç”¨ä¸Šè¿°å‡ ç§æ–¹å¼ï¼Œéƒ½èƒ½å¤Ÿå®ç°åœ¨ç±»å®šä¹‰çš„ç»„ä»¶ä¸­ç»‘å®š this ä¸Šä¸‹æ–‡çš„æ•ˆæœ

  13ã€ç»„ä»¶é—´çš„é€šä¿¡æ–¹æ³•ï¼š
    props
    Events:
        å‘å¸ƒ/è®¢é˜…æ¨¡å¼æ¥ä¸¾ä¾‹ï¼Œè¿™é‡Œå€Ÿç”¨ Node.js Events æ¨¡å—çš„æµè§ˆå™¨ç‰ˆå®ç°ã€‚
        å¦‚æœè¯´ç¨‹åºä¸­å‡ºç°å¤šçº§ä¼ é€’æˆ–è·¨çº§ä¼ é€’æ—¶ï¼Œ é‚£ä¹ˆé¦–å…ˆè¦é‡æ–°å®¡è§†ä¸€ä¸‹æ˜¯å¦æœ‰æ›´åˆç†çš„æ–¹å¼ã€‚Pub/Sub æ¨¡å¼å®ç°çš„è¿‡ç¨‹éå¸¸å®¹æ˜“ç†è§£ï¼Œå³åˆ©ç”¨ å…¨å±€å¯¹è±¡æ¥ä¿å­˜äº‹ä»¶ï¼Œç”¨å¹¿æ’­çš„æ–¹å¼å»å¤„ç†äº‹ä»¶ã€‚è¿™ç§å¸¸è§„çš„è®¾è®¡æ–¹æ³•åœ¨è½¯ä»¶å¼€å‘ä¸­å¤„å¤„å¯è§ï¼Œ ä½†è¿™ç§æ¨¡å¼å¸¦æ¥çš„é—®é¢˜å°±æ˜¯é€»è¾‘å…³ç³»æ··ä¹±ã€‚
        æ–°å»ºä¸€ä¸ªevent.jsæ–‡ä»¶ï¼š
        import { EventEmitter } from 'events'; 
        export default new EventEmitter();

        ç”¨æ³•ï¼š
        çˆ¶ç»„ä»¶å®šä¹‰å‡½æ•°
        import emitter from '@/utils/event';
        componentDidMount() {
          emitter.on('globalChange', function(data) {
            console.log('layout:', data)
          })
        }

        å­ç»„ä»¶è§¦å‘å‡½æ•°å¹¶ä¼ å‚æ•°
        componentDidMount() {
          emitter.emit('globalChange', 'data from children')
        }
    redux
    
  14ã€this.setStateå‡½æ•°æœ‰ä¸‰ç§ç”¨æ³•ï¼š
    // å¯¹è±¡
    this.setState({
    })

    // å‡½æ•°ï¼Œä¸€èˆ¬æ˜¯ç”¨äºåœ¨setStateä¹‹å‰åšä¸€äº›æ“ä½œ
    this.setState(
      () => {
        // TODO
        console.log('')
        return {
          a:300
        }
      }
    )

    // ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¸€èˆ¬æ˜¯ç”¨äºåœ¨setStateä¹‹ååšä¸€äº›æ“ä½œ
    this.setState({
      a:300
    }, () => {
      // TODO
    })

  15ã€setStateä¸ºä»€ä¹ˆæ˜¯å¼‚æ­¥çš„
    https://www.jianshu.com/p/cc12e9a8052c
    setStateåœ¨reacté‡Œçš„åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ˜¯â€œå¼‚æ­¥â€çš„ã€‚
    setStateåœ¨åŸç”Ÿäº‹ä»¶å’ŒsetTimeoutä¸­æ˜¯åŒæ­¥çš„ã€‚

  16ã€setStateå˜æˆåŒæ­¥
    http://cnblogs.com/zhuotiabo/p/6265172.html
    https://www.cnblogs.com/jiuyi/p/9263114.html

    this.setState({val: this.state.val + 1});
    console.log(this.state.val);    // ç¬¬ 1 æ¬¡ log->0

    this.setState({val: this.state.val + 9});
    console.log(this.state.val);    // ç¬¬ 2 æ¬¡ log->0

    setTimeout(() => {
      this.setState({val: this.state.val + 1});
      console.log(this.state.val);  // ç¬¬ 3 æ¬¡ log->10

      this.setState({val: this.state.val + 1});
      console.log(this.state.val);  // ç¬¬ 4 æ¬¡ log->11
    }, 0);


    ç¬¬ä¸€ç§ï¼šå›è°ƒå‡½æ•°
        this.setState({count:1},()=>{
          console.log(this.state.count)//è¾“å‡ºcount=1
        });
    ç¬¬äºŒç§ï¼šæ”¾åœ¨setTimeouté‡Œé¢
        this.setState({val: this.state.val + 9});
        setTimeout(function () {
          console.log(this.state.val) //è·å–æ”¹å˜åçš„val
        }, 0);
    ç¬¬ä¸‰ç§ï¼šes7çš„async/await
        var delay = function (time) {
          return new Promise(function (resolve, reject) {
            setTimeout(function () {
              resolve();
            }, time);
          })
        };
        var start = async function () {
          console.log('a');
          await delay(2000);
          console.log('b');
        };
        start(); //å…ˆè¾“å‡ºaï¼Œç¨ç­‰2ç§’åï¼Œè¾“å‡ºäº†b

        Promiseæ¥å°è£…setState:
        setStateAsync(state) {
          return new Promise((resolve) => {
            this.setState(state, resolve)
          });
        }
        async componentDidMount() {
          await this.setStateAsync({count: 1});
          console.log(this.state.count);//è¾“å‡ºcount=1
        }
    

  17ã€é˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸ºï¼š
    åœ¨ React ä¸­ä½ ä¸èƒ½é€šè¿‡è¿”å› false æ¥é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚å¿…é¡»æ˜ç¡®è°ƒç”¨ preventDefault ã€‚

  18ã€å‰ç«¯ä¸è¦æ“ä½œcookie
    åœ¨åšä¸€äº›å‰åç«¯é‰´æƒçš„æ—¶å€™ï¼Œåç«¯åº”è¯¥å¼€å¯domain,secure,httponlyä¸¥æ ¼æ¨¡å¼ï¼Œç¦æ­¢å‰ç«¯æ“ä½œcookieï¼Œé˜²æ­¢csrfæ”»å‡»ã€‚

  19ã€é˜²æ­¢xssæ”»å‡»
      inputï¼Œtextarea ç­‰æ ‡ç­¾ï¼Œä¸è¦ç›´æ¥æŠŠ html æ–‡æœ¬ç›´æ¥æ¸²æŸ“åœ¨é¡µé¢ä¸Š,ä½¿ç”¨ xssb ç­‰è¿‡æ»¤ä¹‹åå†è¾“å‡ºåˆ°æ ‡ç­¾ä¸Š;
      import { html2text } from 'xss';
      render(){
        <div
          dangerouslySetInnerHTML={{
            __html: html2text(htmlContent)
          }}z
        />
      }

  20ã€åœ¨ç»„ä»¶ä¸­è·å–çœŸå®dom
      ä½¿ç”¨ 16 ç‰ˆæœ¬åçš„ createRef()å‡½æ•°ï¼š
      class MyComponent extends React.Component<iProps, iState> {
        constructor(props) {
          super(props);
          this.inputRef = React.createRef();
        }

        render() {
          return <input type="text" ref={this.inputRef} />;
        }

        componentDidMount() {
          this.inputRef.current.focus();
        }
      }

  21ã€å®¹å™¨å‹ç»„ä»¶å’Œå±•ç¤ºå‹ç»„ä»¶
      å«æœ‰æŠ½è±¡æ•°æ®è€Œæ²¡æœ‰ä¸šåŠ¡é€»è¾‘çš„ç»„ä»¶ï¼Œæˆ‘ä»¬ ç§°ä¹‹ä¸ºå®¹å™¨å‹ç»„ä»¶(container component);
      è€Œæ²¡æœ‰æ•°æ®è¯·æ±‚é€»è¾‘åªæœ‰ä¸šåŠ¡é€»è¾‘çš„ç»„ä»¶ï¼Œæˆ‘ä»¬ç§°ä¹‹ ä¸ºå±•ç¤ºå‹ç»„ä»¶(presentational component)
  
  22ã€creat-react-appè®¾ç½®ä»£ç†ï¼Ÿ
      ï¼ˆ1ï¼‰åœ¨package.jsoné‡Œé¢æ·»åŠ ï¼š
          "proxy": {
            "/v1": {
              "target": "http://172.16.5.148:8001",
              "changeOrigin": true,
              "secure": false
            }
          },
      ï¼ˆ2ï¼‰åœ¨æ–°å»ºsrc/setupProxy.jsæ–‡ä»¶ï¼š
          const proxy = require("http-proxy-middleware");
          module.exports = function(app) {
            app.use(
              proxy("/v1", {
                "target": "http://172.16.5.148:8001",   //é©¬å¥
                "changeOrigin": true,
                "secure": false
              })
            );
            // app.use(
            //   proxy("/v1", {
            //     "target": "http://172.16.5.148:8001",   //
            //     "changeOrigin": true,
            //     "secure": false
            //   })
            // );
          };

          åœ¨scripts/start.jså°†æ–‡ä»¶å¼•å…¥ï¼š
          const devServer = new WebpackDevServer(compiler, serverConfig);
          require('../src/setupProxy')(devServer);

  23ã€æƒé™æ§åˆ¶ï¼š
      https://www.jianshu.com/p/1a5ba1731474
      https://www.jianshu.com/p/508a2d4cb143
      https://segmentfault.com/a/1190000008829420

      ç™»å½•æƒé™
      è·¯ç”±æƒé™
      é¡µé¢çº§çš„æƒé™
      å…ƒç´ çº§çš„æƒé™ï¼šé«˜é˜¶ç»„ä»¶
      vueæƒé™æ§åˆ¶-è‡ªå®šä¹‰æŒ‡ä»¤

  24ã€é«˜é˜¶ç»„ä»¶ï¼š
      é«˜é˜¶ç»„ä»¶å¯ä»¥çœ‹åšæ˜¯è£…é¥°å™¨æ¨¡å¼(Decorator Pattern)åœ¨Reactçš„å®ç°ã€‚
      å³å…è®¸å‘ä¸€ä¸ªç°æœ‰çš„å¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ï¼ŒåŒæ—¶åˆä¸æ”¹å˜å…¶ç»“æ„ï¼Œå±äºåŒ…è£…æ¨¡å¼(Wrapper Pattern)çš„ä¸€ç§

  25ã€ä¸ºä»€ä¹ˆè¦å¼•å…¥React
      åœ¨å†™ React çš„æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šå†™ç±»ä¼¼è¿™æ ·çš„ä»£ç ï¼š

      import React from 'react'

      function A() {
        // ...other code
        return <h1>å‰ç«¯æ¡ƒå›­</h1>
      }
      ä½ è‚¯å®šç–‘æƒ‘è¿‡ï¼Œä¸‹é¢çš„ä»£ç éƒ½æ²¡æœ‰ç”¨åˆ° Reactï¼Œä¸ºä»€ä¹ˆè¦å¼•å…¥ React å‘¢ï¼Ÿ

      å¦‚æœä½ æŠŠ import React from â€˜reactâ€™ åˆ æ‰ï¼Œè¿˜ä¼šæŠ¥ä¸‹é¢è¿™æ ·çš„é”™è¯¯ï¼š

      é‚£ä¹ˆç©¶ç«Ÿæ˜¯å“ªé‡Œç”¨åˆ°äº†è¿™ä¸ª Reactï¼Œå¯¼è‡´æˆ‘ä»¬å¼•å…¥ React ä¼šæŠ¥é”™å‘¢ï¼Œä¸æ‡‚è¿™ä¸ªåŸå› ï¼Œé‚£ä¹ˆå°±æ˜¯ JSX æ²¡æœ‰æå¾—å¤ªæ˜ç™½ã€‚

      ä½ å¯ä»¥è®²ä¸Šé¢çš„ä»£ç (å¿½ç•¥å¯¼å…¥è¯­å¥)æ”¾åˆ°åœ¨çº¿ babel é‡Œè¿›è¡Œè½¬åŒ–ä¸€ä¸‹ï¼Œå‘ç° babel ä¼šæŠŠä¸Šé¢çš„ä»£ç è½¬åŒ–æˆ:

      function A() {
        // ...other code
        return React.createElement("h1", null, "å‰ç«¯æ¡ƒå›­");
      }
      å› ä¸ºä»æœ¬è´¨ä¸Šè®²ï¼ŒJSX åªæ˜¯ä¸º React.createElement(component, props, ...children) å‡½æ•°æä¾›çš„è¯­æ³•ç³–ã€‚

  26ã€ä¸ºä»€ä¹ˆè¦ç”¨classNameè€Œä¸ç”¨class
      React ä¸€å¼€å§‹çš„ç†å¿µæ˜¯æƒ³ä¸æµè§ˆå™¨çš„ DOM API ä¿æŒä¸€ç›´è€Œä¸æ˜¯ HTMLï¼Œå› ä¸º JSX æ˜¯ JS çš„æ‰©å±•ï¼Œè€Œä¸æ˜¯ç”¨æ¥ä»£æ›¿ HTML çš„ï¼Œè¿™æ ·ä¼šå’Œå…ƒç´ çš„åˆ›å»ºæ›´ä¸ºæ¥è¿‘ã€‚åœ¨å…ƒç´ ä¸Šè®¾ç½® class éœ€è¦ä½¿ç”¨ className è¿™ä¸ª APIï¼š

      const element = document.createElement("div")
      element.className = "hello" 
      æµè§ˆå™¨é—®é¢˜ï¼ŒES5 ä¹‹å‰ï¼Œåœ¨å¯¹è±¡ä¸­ä¸èƒ½ä½¿ç”¨ä¿ç•™å­—ã€‚ä»¥ä¸‹ä»£ç åœ¨ IE8 ä¸­å°†ä¼šæŠ›å‡ºé”™è¯¯ï¼š

      const element = {
        attributes: {
          class: "hello"
        }
      } 
      è§£æ„é—®é¢˜ï¼Œå½“ä½ åœ¨è§£æ„å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœåˆ†é…ä¸€ä¸ª class å˜é‡ä¼šå‡ºé—®é¢˜ï¼š

      const { class } = { class: 'foo' } // Uncaught SyntaxError: Unexpected token }
      const { className } = { className: 'foo' } 
      const { class: className } = { class: 'foo' } 
      å…¶ä»–è®¨è®ºå¯è§ï¼šæœ‰è¶£çš„è¯é¢˜ï¼Œä¸ºä»€ä¹ˆjsxç”¨classNameè€Œä¸æ˜¯class

  27ã€ä¸ºä»€ä¹ˆå±æ€§è¦ç”¨å°é©¼å³°
      å› ä¸º JSX è¯­æ³•ä¸Šæ›´æ¥è¿‘ JavaScript è€Œä¸æ˜¯ HTMLï¼Œæ‰€ä»¥ React DOM ä½¿ç”¨ camelCaseï¼ˆå°é©¼å³°å‘½åï¼‰æ¥å®šä¹‰å±æ€§çš„åç§°ï¼Œè€Œä¸ä½¿ç”¨ HTML å±æ€§åç§°çš„å‘½åçº¦å®šã€‚

  28ã€ä¸ºä»€ä¹ˆ constructor é‡Œè¦è°ƒç”¨ super å’Œä¼ é€’ props
      è¿™æ˜¯å®˜ç½‘çš„ä¸€æ®µä»£ç ï¼Œå…·ä½“è§ï¼šçŠ¶æ€(State) å’Œ ç”Ÿå‘½å‘¨æœŸ

      class Clock extends React.Component {
        constructor(props) {
          super(props);
          this.state = {date: new Date()};
        }

        render() {
          return (
            <div>
              <h1>Hello, world!</h1>
              <h2>It is {this.state.date.toLocaleTimeString()}.</h2>
            </div>
          );
        }
      }
      è€Œä¸”æœ‰è¿™ä¹ˆä¸€æ®µè¯ï¼Œä¸ä»…è®©æˆ‘ä»¬è°ƒç”¨ super è¿˜è¦æŠŠ props ä¼ é€’è¿›å»ï¼Œä½†æ˜¯æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšã€‚

      image-20190901222456704
      image-20190901222456704
      ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰ç–‘æƒ‘è¿‡ä¸ºä»€ä¹ˆè¦è°ƒç”¨ super å’Œä¼ é€’ propsï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥è§£å¼€è°œé¢˜å§ã€‚

      ä¸ºä»€ä¹ˆè¦è°ƒç”¨ super

      å…¶å®è¿™ä¸æ˜¯ React çš„é™åˆ¶ï¼Œè¿™æ˜¯ JavaScript çš„é™åˆ¶ï¼Œåœ¨æ„é€ å‡½æ•°é‡Œå¦‚æœè¦è°ƒç”¨ thisï¼Œé‚£ä¹ˆæå‰å°±è¦è°ƒç”¨ superï¼Œåœ¨ React é‡Œï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šåœ¨æ„é€ å‡½æ•°é‡Œåˆå§‹åŒ– stateï¼Œthis.state = xxx ï¼Œæ‰€ä»¥éœ€è¦è°ƒç”¨ superã€‚

      ä¸ºä»€ä¹ˆè¦ä¼ é€’ props

      ä½ å¯èƒ½ä»¥ä¸ºå¿…é¡»ç»™ super ä¼ å…¥ propsï¼Œå¦åˆ™ React.Component å°±æ²¡æ³•åˆå§‹åŒ– this.propsï¼š

      class Component {
        constructor(props) {
          this.props = props;
          // ...
        }
      }
      ä¸è¿‡ï¼Œå¦‚æœä½ ä¸å°å¿ƒæ¼ä¼ äº† propsï¼Œç›´æ¥è°ƒç”¨äº† super()ï¼Œä½ ä»ç„¶å¯ä»¥åœ¨ render å’Œå…¶ä»–æ–¹æ³•ä¸­è®¿é—® this.propsï¼ˆä¸ä¿¡çš„è¯å¯ä»¥è¯•è¯•å˜›ï¼‰ã€‚

      ä¸ºå•¥è¿™æ ·ä¹Ÿè¡Œï¼Ÿå› ä¸ºReact ä¼šåœ¨æ„é€ å‡½æ•°è¢«è°ƒç”¨ä¹‹åï¼Œä¼šæŠŠ props èµ‹å€¼ç»™åˆšåˆšåˆ›å»ºçš„å®ä¾‹å¯¹è±¡ï¼š

      const instance = new YourComponent(props);
      instance.props = props;
      props ä¸ä¼ ä¹Ÿèƒ½ç”¨ï¼Œæ˜¯æœ‰åŸå› çš„ã€‚

      ä½†è¿™æ„å‘³ç€ä½ åœ¨ä½¿ç”¨ React æ—¶ï¼Œå¯ä»¥ç”¨ super() ä»£æ›¿ super(props) äº†ä¹ˆï¼Ÿ

      é‚£è¿˜æ˜¯ä¸è¡Œçš„ï¼Œä¸ç„¶å®˜ç½‘ä¹Ÿä¸ä¼šå»ºè®®ä½ è°ƒç”¨ props äº†ï¼Œè™½ç„¶ React ä¼šåœ¨æ„é€ å‡½æ•°è¿è¡Œä¹‹åï¼Œä¸º this.props èµ‹å€¼ï¼Œä½†åœ¨ super() è°ƒç”¨ä¹‹åä¸æ„é€ å‡½æ•°ç»“æŸä¹‹å‰ï¼Œ this.props ä»ç„¶æ˜¯æ²¡æ³•ç”¨çš„ã€‚

      // Inside React
      class Component {
        constructor(props) {
          this.props = props;
          // ...
        }
      }

      // Inside your code
      class Button extends React.Component {
        constructor(props) {
          super(); // ğŸ˜¬ å¿˜äº†ä¼ å…¥ props
          console.log(props); // âœ… {}
          console.log(this.props); // ğŸ˜¬ undefined
        }
        // ...
      }
      è¦æ˜¯æ„é€ å‡½æ•°ä¸­è°ƒç”¨äº†æŸä¸ªè®¿é—® props çš„æ–¹æ³•ï¼Œé‚£è¿™ä¸ª bug å°±æ›´éš¾å®šä½äº†ã€‚å› æ­¤æˆ‘å¼ºçƒˆå»ºè®®å§‹ç»ˆä½¿ç”¨super(props)ï¼Œå³ä½¿è¿™ä¸æ˜¯å¿…é¡»çš„ï¼š

      class Button extends React.Component {
        constructor(props) {
          super(props); // âœ… We passed props
          console.log(props); // âœ… {}
          console.log(this.props); // âœ… {}
        }
        // ...
      }
      ä¸Šé¢çš„ä»£ç ç¡®ä¿ this.props å§‹ç»ˆæ˜¯æœ‰å€¼çš„ã€‚

      å¦‚æœä½ æƒ³é¿å…ä»¥ä¸Šçš„é—®é¢˜ï¼Œä½ å¯ä»¥é€šè¿‡class å±æ€§ææ¡ˆ æ¥ç®€åŒ–ä»£ç ï¼š

      class Clock extends React.Component {
        state = {date: new Date()};

        render() {
          return (
            <div>
              <h1>Hello, world!</h1>
              <h2>It is {this.state.date.toLocaleTimeString()}.</h2>
            </div>
          );
        }
      }
      æ›´è¯¦ç»†çš„å†…å®¹å¯è§Dan çš„åšå®¢

  29ã€ä¸ºä»€ä¹ˆç»„ä»¶ç”¨å¤§å†™å¼€å¤´
      å‰é¢ä»¥åŠè¯´è¿‡äº†ï¼ŒJSX æ˜¯ React.createElement(component, props, â€¦children) æä¾›çš„è¯­æ³•ç³–ï¼Œcomponent çš„ç±»å‹æ˜¯ï¼šstring/ReactClass typeï¼Œæˆ‘ä»¬å…·ä½“çœ‹ä¸€ä¸‹åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šç”¨åˆ° string ç±»å‹ï¼Œä»€ä¹ˆæƒ…å†µä¸‹ç”¨åˆ° ReactClass type ç±»å‹

      string ç±»å‹reactä¼šè§‰å¾—ä»–æ˜¯ä¸€ä¸ªåŸç”ŸdomèŠ‚ç‚¹

      ReactClass type ç±»å‹ è‡ªå®šä¹‰ç»„ä»¶

      ä¾‹å¦‚ï¼ˆstringï¼‰ï¼šåœ¨ jsx ä¸­æˆ‘ä»¬å†™ä¸€ä¸ª

      <div></div>
      è½¬æ¢ä¸ºjsçš„æ—¶å€™å°±å˜æˆäº†

      React.createElement("div", null)
      ä¾‹å¦‚ï¼ˆReactClass typeï¼‰ï¼šåœ¨jsxä¸­æˆ‘ä»¬å†™ä¸€ä¸ª

      function MyDiv() {
          return (<div><div>)
      }
      <MyDiv></MyDiv>
      è½¬æ¢ä¸ºjsçš„æ—¶å€™å°±å˜æˆäº†

      function MyDiv() {
        return React.createElement("div", null);
      }

      React.createElement(MyDiv, null);
      ä¸Šè¾¹çš„ä¾‹å­ä¸­å¦‚æœå°†MyDivä¸­çš„é¦–å­—æ¯å°å†™ï¼Œå¦‚ä¸‹

      function myDiv() {
          return (<div><div>)
      }
      <myDiv></myDiv>
      è½¬æ¢ä¸º js çš„æ—¶å€™å°±å˜æˆäº†

      function MyDiv() {
        return React.createElement("div", null);
      }

      React.createElement("myDiv", null);
      ç”±äºæ‰¾ä¸åˆ° myDiv è¿™ä¸ª domï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™ã€‚
  
  30ã€ä¸ºä»€ä¹ˆè°ƒç”¨æ–¹æ³•è¦ bind this
      å‰æçŸ¥è¯†ï¼šæ·±åˆ»çš„ç†è§£ JavaScript ä¸­çš„ this

      ç›¸ä¿¡åˆšå†™ React çš„æ—¶å€™ï¼Œå¾ˆå¤šæœ‹å‹å¯èƒ½ä¼šå†™ç±»ä¼¼è¿™æ ·çš„ä»£ç ï¼š

      class Foo extends React.Component {
        handleClick () {
          this.setState({ xxx: aaa })
        }

        render() {
          return (
            <button onClick={this.handleClick}>
              Click me
            </button>
          )
        }
      }
      å‘ç°ä¼šæŠ¥ this æ˜¯ undefined çš„é”™ï¼Œç„¶åå¯èƒ½å¯¹äº‹ä»¶å¤„ç†æ¯”è¾ƒç–‘æƒ‘ï¼Œç„¶åå»çœ‹å®˜ç½‘çš„äº‹ä»¶å¤„ç†æœ‰ä¸‹é¢ä¸€æ®µè¯ï¼š

      ä½ å¿…é¡»è°¨æ…å¯¹å¾… JSX å›è°ƒå‡½æ•°ä¸­çš„ thisï¼Œåœ¨ JavaScript ä¸­ï¼Œclass çš„æ–¹æ³•é»˜è®¤ä¸ä¼šç»‘å®šthisã€‚å¦‚æœä½ å¿˜è®°ç»‘å®š this.handleClick å¹¶æŠŠå®ƒä¼ å…¥äº† onClickï¼Œå½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ this çš„å€¼ä¸º undefinedã€‚

      è¿™å¹¶ä¸æ˜¯ React ç‰¹æœ‰çš„è¡Œä¸ºï¼›è¿™å…¶å®ä¸ JavaScript å‡½æ•°å·¥ä½œåŸç†æœ‰å…³ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æ²¡æœ‰åœ¨æ–¹æ³•åé¢æ·»åŠ  ()ï¼Œä¾‹å¦‚ onClick={this.handleClick}ï¼Œä½ åº”è¯¥ä¸ºè¿™ä¸ªæ–¹æ³•ç»‘å®š thisã€‚

      ç„¶åä½ çœ‹äº†å®˜ç½‘çš„ä¾‹å­å’Œå»ºè®®ä¹‹åï¼ŒçŸ¥é“éœ€è¦ä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ç»‘å®š thiså°±èƒ½è§£å†³ï¼Œæƒ³ä¸‹é¢è¿™æ ·ï¼š

      class Foo extends React.Component {
        handleClick () {
          this.setState({ xxx: aaa })
        }

        render() {
          return (
            <button onClick={this.handleClick.bind(this)}>
              Click me
            </button>
          )
        }
      }
      ä½†æ˜¯å¯èƒ½ä½ æ²¡æœ‰å»æ€è€ƒè¿‡ä¸ºä»€ä¹ˆéœ€è¦ bind thisï¼Ÿå¦‚æœä½ ä¸èƒ½ç†è§£çš„è¯ï¼Œè¿˜æ˜¯ js çš„åŸºç¡€æ²¡æœ‰æ‰“å¥½ã€‚

      React æ˜¯å¦‚ä½•å¤„ç†äº‹ä»¶çš„ï¼Ÿ

      å’±ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ React æ˜¯å¦‚ä½•å¤„ç†äº‹ä»¶çš„ã€‚

      React çš„äº‹ä»¶æ˜¯åˆæˆäº‹ä»¶ï¼Œ å†…éƒ¨åŸç†éå¸¸å¤æ‚ï¼Œæˆ‘è¿™é‡ŒåªæŠŠå…³é”®æ€§ï¼Œå¯ä»¥ç”¨æ¥è§£ç­”è¿™ä¸ªé—®é¢˜çš„åŸç†éƒ¨åˆ†è¿›è¡Œä»‹ç»å³å¯(åé¢åº”è¯¥ä¼šå†™ä¸€ç¯‡ react çš„äº‹ä»¶åŸç†ï¼Œæ•¬è¯·æœŸå¾…)ã€‚

      ä¸Šç¯‡æ–‡ç« å·²ç»è¯´è¿‡ï¼Œjsx å®é™…ä¸Šæ˜¯ React.createElement(component, props, â€¦children) å‡½æ•°æä¾›çš„è¯­æ³•ç³–ï¼Œé‚£ä¹ˆè¿™æ®µ jsx ä»£ç ï¼š

      <button onClick={this.handleClick}>
          Click me
      </button>
      ä¼šè¢«è½¬åŒ–ä¸ºï¼š

      React.createElement("button", {
          onClick: this.handleClick
      }, "Click me")
      äº†è§£äº†ä¸Šé¢çš„ï¼Œç„¶åç®€å•çš„ç†è§£ react å¦‚ä½•å¤„ç†äº‹ä»¶çš„ï¼ŒReact åœ¨ç»„ä»¶åŠ è½½(mount)å’Œæ›´æ–°(update)æ—¶ï¼Œå°†äº‹ä»¶é€šè¿‡ addEventListener  ç»Ÿä¸€æ³¨å†Œåˆ° document ä¸Šï¼Œç„¶åä¼šæœ‰ä¸€ä¸ªäº‹ä»¶æ± å­˜å‚¨äº†æ‰€æœ‰çš„äº‹ä»¶ï¼Œå½“äº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œé€šè¿‡ dispatchEvent è¿›è¡Œäº‹ä»¶åˆ†å‘ã€‚

      æ‰€ä»¥ä½ å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼Œæœ€ç»ˆ this.handleClick ä¼šä½œä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°è°ƒç”¨ã€‚

      ç†è§£äº†è¿™ä¸ªï¼Œç„¶åå†æ¥çœ‹çœ‹å›è°ƒå‡½æ•°ä¸ºä»€ä¹ˆå°±ä¼šä¸¢å¤± thisã€‚

      this ç®€å•å›é¡¾

      åœ¨å‡½æ•°å†…éƒ¨ï¼Œthisçš„å€¼å–å†³äºå‡½æ•°è¢«è°ƒç”¨çš„æ–¹å¼ã€‚

      å¦‚æœä½ ä¸èƒ½ç†è§£ä¸Šé¢é‚£å¥è¯ï¼Œé‚£ä¹ˆä½ å¯èƒ½éœ€è¦åœä¸‹æ¥é˜…è¯»æ–‡ç« ï¼Œå»æŸ¥ä¸€ä¸‹ç›¸å…³èµ„æ–™ï¼Œå¦åˆ™ä½ å¯èƒ½çœ‹ä¸æ‡‚ä¸‹é¢çš„ï¼Œå¦‚æœä½ æ‡’çš„è¯ï¼Œå°±çœ‹ä¸ºä½ å‡†å¤‡å¥½çš„ MDN å§ã€‚

      é€šè¿‡ä¸Šé¢å¯¹äº‹ä»¶å¤„ç†çš„ä»‹ç»ï¼Œæ¥æ¨¡æ‹Ÿä¸€ä¸‹åœ¨ç±»ç»„ä»¶çš„ render å‡½æ•°ä¸­ï¼Œ æœ‰ç‚¹ç±»ä¼¼äºåšäº†è¿™æ ·çš„æ“ä½œ:

      class Foo {
          sayThis () {
              console.log(this); // è¿™é‡Œçš„ `this` æŒ‡å‘è°ï¼Ÿ
          }

          exec (cb) {
              cb();
          }

          render () {
              this.exec(this.sayThis);
          }
      }

      var foo = new Foo();
      foo.render(); // è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ
      ä½ ä¼šå‘ç°æœ€ç»ˆç»“æœè¾“å‡ºçš„æ˜¯ undefinedï¼Œå¦‚æœä½ ä¸ç†è§£ä¸ºä»€ä¹ˆè¾“å‡ºçš„æ˜¯ undefinedï¼Œé‚£ä¹ˆè¿˜æ˜¯ä¸Šé¢è¯´çš„ï¼Œéœ€è¦å»æ·±åˆ»çš„ç†è§£ this çš„åŸç†ã€‚å¦‚æœä½ èƒ½ç†è§£è¾“å‡ºçš„æ˜¯ undefinedï¼Œé‚£ä¹ˆæˆ‘è§‰å¾—ä½ å°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆéœ€è¦ bind this äº†ã€‚

      é‚£ä¹ˆä½ å¯èƒ½ä¼šé—®ï¼šä¸ºä»€ä¹ˆReactæ²¡æœ‰è‡ªåŠ¨çš„æŠŠ bind é›†æˆåˆ° render æ–¹æ³•ä¸­å‘¢?åœ¨ exec è°ƒç”¨å›è°ƒçš„æ—¶å€™ç»‘å®šè¿›å»ï¼Œåƒè¿™æ ·ï¼š

      class Foo {
          sayThis () {
              console.log(this); // è¿™é‡Œçš„ `this` æŒ‡å‘è°ï¼Ÿ
          }

          exec (cb) {
              cb().bind(this);
          }

          render () {
              this.exec(this.sayThis);
        }
      }

      var foo = new Foo();
      foo.render(); // è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ
      å› ä¸º render å¤šæ¬¡è°ƒç”¨æ¯æ¬¡éƒ½è¦ bind ä¼šå½±å“æ€§èƒ½ï¼Œæ‰€ä»¥å®˜æ–¹å»ºè®®ä½ è‡ªå·±åœ¨ constructor ä¸­æ‰‹åŠ¨ bind è¾¾åˆ°æ€§èƒ½ä¼˜åŒ–ã€‚

      å››ç§äº‹ä»¶å¤„ç†å¯¹æ¯”
      å¯¹äºäº‹ä»¶å¤„ç†çš„å†™æ³•ä¹Ÿæœ‰å¥½å‡ ç§ï¼Œå’±ä»¬æ¥è¿›è¡Œå¯¹æ¯”ä¸€ä¸‹ï¼š

      1. ç›´æ¥ bind this å‹

      å°±æ˜¯åƒæ–‡ç« å¼€å§‹çš„é‚£æ ·ï¼Œç›´æ¥åœ¨äº‹ä»¶é‚£é‡Œ bind this

      class Foo extends React.Component {
        handleClick () {
          this.setState({ xxx: aaa })
        }

        render() {
          return (
            <button onClick={this.handleClick.bind(this)}>
              Click me
            </button>
          )
        }
      }
      ä¼˜ç‚¹ï¼šå†™èµ·æ¥é¡ºæ‰‹ï¼Œä¸€å£æ°”å°±èƒ½æŠŠè¿™ä¸ªé€»è¾‘å†™å®Œï¼Œä¸ç”¨ç§»åŠ¨å…‰æ ‡åˆ°å…¶ä»–åœ°æ–¹ã€‚

      ç¼ºç‚¹ï¼šæ€§èƒ½ä¸å¤ªå¥½ï¼Œè¿™ç§æ–¹å¼è·Ÿ react å†…éƒ¨å¸®ä½  bind ä¸€æ ·çš„ï¼Œæ¯æ¬¡ render éƒ½ä¼šè¿›è¡Œ bindï¼Œè€Œä¸”å¦‚æœæœ‰ä¸¤ä¸ªå…ƒç´ çš„äº‹ä»¶å¤„ç†å‡½æ•°å¼åŒä¸€ä¸ªï¼Œä¹Ÿè¿˜æ˜¯è¦è¿›è¡Œ bindï¼Œè¿™æ ·ä¼šå¤šå†™ç‚¹ä»£ç ï¼Œè€Œä¸”è¿›è¡Œä¸¤æ¬¡ bindï¼Œæ€§èƒ½ä¸æ˜¯å¤ªå¥½ã€‚(å…¶å®è¿™ç‚¹æ€§èƒ½å¾€å¾€ä¸ä¼šæ˜¯æ€§èƒ½ç“¶é¢ˆçš„åœ°æ–¹ï¼Œå¦‚æœä½ è§‰å¾—é¡ºæ‰‹ï¼Œè¿™æ ·å†™å®Œå…¨æ²¡é—®é¢˜)

      2. constuctor æ‰‹åŠ¨ bind å‹

      class Foo extends React.Component {
        constuctor(props) {
          super(props)
          this.handleClick = this.handleClick.bind(this)
        }
        handleClick () {
          this.setState({ xxx: aaa })
        }

        render() {
          return (
            <button onClick={this.handleClick}>
              Click me
            </button>
          )
        }
      }
      ä¼˜ç‚¹ï¼šç›¸æ¯”äºç¬¬ä¸€ç§æ€§èƒ½æ›´å¥½ï¼Œå› ä¸ºæ„é€ å‡½æ•°åªæ‰§è¡Œä¸€æ¬¡ï¼Œé‚£ä¹ˆåªä¼š bind ä¸€æ¬¡ï¼Œè€Œä¸”å¦‚æœæœ‰å¤šä¸ªå…ƒç´ éƒ½éœ€è¦è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿä¸éœ€è¦é‡å¤ bindï¼ŒåŸºæœ¬ä¸Šè§£å†³äº†ç¬¬ä¸€ç§çš„ä¸¤ä¸ªç¼ºç‚¹ã€‚

      ç¼ºç‚¹ï¼šæ²¡æœ‰æ˜æ˜¾ç¼ºç‚¹ï¼Œç¡¬è¦è¯´çš„è¯å°±æ˜¯å¤ªä¸‘äº†ï¼Œç„¶åä¸é¡ºæ‰‹(æˆ‘è§‰å¾—ä¸‘ï¼Œä½ è§‰å¾—ä¸ä¸‘å°±è¿™ä¹ˆå†™å°±è¡Œäº†)ã€‚

      3. ç®­å¤´å‡½æ•°å‹

      class Foo extends React.Component {
        handleClick () {
          this.setState({ xxx: aaa })
        }

        render() {
          return (
            <button onClick={(e) => this.handleClick(e)}>
              Click me
            </button>
          )
        }
      }
      ä¼˜ç‚¹ï¼šé¡ºæ‰‹ï¼Œå¥½çœ‹ã€‚

      ç¼ºç‚¹ï¼šæ¯æ¬¡ render éƒ½ä¼šé‡å¤åˆ›å»ºå‡½æ•°ï¼Œæ€§èƒ½ä¼šå·®ä¸€ç‚¹ã€‚

      4. public class fields å‹

      è¿™ç§ class fieldsè¿˜å¤„äºå®éªŒé˜¶æ®µï¼Œæ®æˆ‘æ‰€çŸ¥ç›®å‰è¿˜æ²¡æœ‰è¢«çº³å…¥æ ‡å‡†ï¼Œå…·ä½“å¯è§è¿™é‡Œã€‚

      class Foo extends React.Component {
        handleClick = () => {
          this.setState({ xxx: aaa })
        }

        render() {
          return (
            <button onClick={this.handleClick}>
              Click me
            </button>
          )
        }
      }
      ä¼˜ç‚¹ï¼šå¥½çœ‹ï¼Œæ€§èƒ½å¥½ã€‚

      ç¼ºç‚¹ï¼šæ²¡æœ‰æ˜æ˜¾ç¼ºç‚¹ï¼Œå¦‚æœç¡¬è¦è¯´å¯èƒ½å°±æ˜¯è¦å¤šè£…ä¸€ä¸ª babel æ’ä»¶æ¥æ”¯æŒè¿™ç§è¯­æ³•ã€‚

      æ€»ç»“
      æˆ‘å¹³æ—¶ç”¨çš„å°±è¿™å››ç§å†™æ³•ï¼Œæˆ‘è¿™è¾¹ä»ä»£ç çš„ç¾è§‚æ€§ã€æ€§èƒ½ä»¥åŠæ˜¯å¦é¡ºæ‰‹æ–¹ä¾¿å¯¹å„ç§å†™æ³•åšäº†ç®€å•çš„å¯¹æ¯”ã€‚å…¶å®æ¯ç§æ–¹æ³•åœ¨é¡¹ç›®é‡Œç”¨éƒ½æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜çš„ï¼Œæ€§èƒ½æ–¹é¢åŸºæœ¬ä¸Šå¯ä»¥å¿½ç•¥ï¼Œå¯¹äºç¾è§‚æ€§å’Œé¡ºæ‰‹æ¯”è¾ƒä¸»è§‚ï¼Œæ‰€ä»¥æ€»ä½“æ¥è¯´å°±æ˜¯çœ‹å¤§å®¶çš„åå¥½å’¯ï¼Œå¦‚æœç¡¬è¦æ¨èçš„è¯ï¼Œæˆ‘è¿˜æ˜¯æ¯”è¾ƒæ¨èç¬¬å››ç§å†™æ³•ï¼Œç¾è§‚è€Œä¸”ä¸å½±å“æ€§èƒ½ã€‚

  31ã€ä¸ºä»€ä¹ˆè¦ setStateï¼Œè€Œä¸æ˜¯ç›´æ¥ this.state.xx = oo
      è¿™ä¸ªé—®é¢˜æ˜¯æˆ‘ä»¬å…¬å¸åç«¯å†™ React çš„æ—¶å€™æå‡ºçš„é—®é¢˜ï¼Œä¸ºå•¥ä¸èƒ½ç›´æ¥ä¿®æ”¹ stateï¼Œè¦ setState ä¸€ä¸‹ã€‚æˆ‘åœ¨æƒ³ï¼Œä» vue è½¬åˆ° React å¯èƒ½ä¹Ÿä¼šæœ‰è¿™ç§ç–‘é—®ï¼Œå› ä¸º vue ä¿®æ”¹çŠ¶æ€éƒ½æ˜¯ç›´æ¥æ”¹çš„ã€‚

      å¦‚æœæˆ‘ä»¬äº†è§£ setState çš„åŸç†çš„è¯ï¼Œå¯èƒ½å°±èƒ½è§£ç­”è¿™ä¸ªé—®é¢˜äº†ï¼ŒsetState åšçš„äº‹æƒ…ä¸ä»…ä»…åªæ˜¯ä¿®æ”¹äº† this.state çš„å€¼ï¼Œå¦å¤–æœ€é‡è¦çš„æ˜¯å®ƒä¼šè§¦å‘ React çš„æ›´æ–°æœºåˆ¶ï¼Œä¼šè¿›è¡Œ diff ï¼Œç„¶åå°† patch éƒ¨åˆ†æ›´æ–°åˆ°çœŸå® dom é‡Œã€‚

      å¦‚æœä½ ç›´æ¥ this.state.xx == oo çš„è¯ï¼Œstate çš„å€¼ç¡®å®ä¼šæ”¹ï¼Œä½†æ˜¯æ”¹äº†ä¸ä¼šè§¦å‘ UI çš„æ›´æ–°ï¼Œé‚£å°±ä¸æ˜¯æ•°æ®é©±åŠ¨äº†ã€‚

      é‚£ä¸ºä»€ä¹ˆ Vue ç›´æ¥ä¿®æ”¹ data å¯ä»¥è§¦å‘ UI çš„æ›´æ–°å‘¢ï¼Ÿå› ä¸º Vue åœ¨åˆ›å»º UI çš„æ—¶å€™ä¼šæŠŠè¿™äº› data ç»™æ”¶é›†èµ·æ¥ï¼Œå¹¶ä¸”åœ¨è¿™äº› data çš„è®¿é—®å™¨å±æ€§ setter è¿›è¡Œäº†é‡å†™ï¼Œåœ¨è¿™ä¸ªé‡å†™çš„æ–¹æ³•é‡Œä¼šå»è§¦å‘ UI çš„æ›´æ–°ã€‚å¦‚æœä½ æƒ³æ›´å¤šçš„äº†è§£ vue çš„åŸç†ï¼Œå¯ä»¥å»è´­ä¹°æŸ“é™Œå¤§ä½¬çš„å‰–æ Vue.js å†…éƒ¨è¿è¡Œæœºåˆ¶ã€‚

      ä¸æ˜ç™½è®¿é—®å™¨å±æ€§çš„å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼šæ·±å…¥ç†è§£JSé‡Œçš„å¯¹è±¡
  
  32ã€setStateæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ç›¸å…³é—®é¢˜
      1. setState æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ

        æˆ‘çš„å›ç­”æ˜¯æ‰§è¡Œè¿‡ç¨‹ä»£ç åŒæ­¥çš„ï¼Œåªæ˜¯åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°çš„è°ƒç”¨é¡ºåºåœ¨æ›´æ–°ä¹‹å‰ï¼Œå¯¼è‡´åœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ²¡æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åçš„å€¼ï¼Œå½¢å¼äº†æ‰€è°“çš„â€œå¼‚æ­¥â€ï¼Œæ‰€ä»¥è¡¨ç°å‡ºæ¥æœ‰æ—¶æ˜¯åŒæ­¥ï¼Œæœ‰æ—¶æ˜¯â€œå¼‚æ­¥â€ã€‚

      2. ä½•æ—¶æ˜¯åŒæ­¥ï¼Œä½•æ—¶æ˜¯å¼‚æ­¥å‘¢ï¼Ÿ

        åªåœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ˜¯â€œå¼‚æ­¥â€çš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’Œ setTimeout/setIntervalç­‰åŸç”Ÿ API ä¸­éƒ½æ˜¯åŒæ­¥çš„ã€‚ç®€å•çš„å¯ä»¥ç†è§£ä¸ºè¢« React æ§åˆ¶çš„å‡½æ•°é‡Œé¢å°±ä¼šè¡¨ç°å‡ºâ€œå¼‚æ­¥â€ï¼Œåä¹‹è¡¨ç°ä¸ºåŒæ­¥ã€‚

      3. é‚£ä¸ºä»€ä¹ˆä¼šå‡ºç°å¼‚æ­¥çš„æƒ…å†µå‘¢ï¼Ÿ

        ä¸ºäº†åšæ€§èƒ½ä¼˜åŒ–ï¼Œå°† state çš„æ›´æ–°å»¶ç¼“åˆ°æœ€åæ‰¹é‡åˆå¹¶å†å»æ¸²æŸ“å¯¹äºåº”ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ˜¯æœ‰æå¤§å¥½å¤„çš„ï¼Œå¦‚æœæ¯æ¬¡çš„çŠ¶æ€æ”¹å˜éƒ½å»é‡æ–°æ¸²æŸ“çœŸå® domï¼Œé‚£ä¹ˆå®ƒå°†å¸¦æ¥å·¨å¤§çš„æ€§èƒ½æ¶ˆè€—ã€‚

      4. é‚£å¦‚ä½•åœ¨è¡¨ç°å‡ºå¼‚æ­¥çš„å‡½æ•°é‡Œå¯ä»¥å‡†ç¡®æ‹¿åˆ°æ›´æ–°åçš„ state å‘¢ï¼Ÿ

        é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° setState(partialState, callback) ä¸­çš„ callback æ‹¿åˆ°æ›´æ–°åçš„ç»“æœã€‚

        æˆ–è€…å¯ä»¥é€šè¿‡ç»™ setState ä¼ é€’å‡½æ•°æ¥è¡¨ç°å‡ºåŒæ­¥çš„æƒ…å†µï¼š

        this.setState((state) => {
          return { val: newVal }
        })
      5. é‚£è¡¨ç°å‡ºå¼‚æ­¥çš„åŸç†æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ

        ç›´æ¥è®²æºç è‚¯å®šç¯‡å¹…ä¸å¤Ÿï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼šä½ çœŸçš„ç†è§£setStateå—ï¼Ÿã€‚

        æˆ‘è¿™é‡Œè¿˜æ˜¯ç”¨æœ€ç®€å•çš„è¯­è¨€è®©ä½ ç†è§£ï¼šåœ¨ React çš„ setState å‡½æ•°å®ç°ä¸­ï¼Œä¼šæ ¹æ® isBatchingUpdates(é»˜è®¤æ˜¯ false) å˜é‡åˆ¤æ–­æ˜¯å¦ç›´æ¥æ›´æ–° this.state è¿˜æ˜¯æ”¾åˆ°é˜Ÿåˆ—ä¸­ç¨åæ›´æ–°ã€‚ç„¶åæœ‰ä¸€ä¸ª batchedUpdate å‡½æ•°ï¼Œå¯ä»¥ä¿®æ”¹ isBatchingUpdates ä¸º trueï¼Œå½“ React è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°ä¹‹å‰ï¼Œæˆ–è€…ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¹‹å‰å°±ä¼šè°ƒç”¨ batchedUpdate å‡½æ•°ï¼Œè¿™æ ·çš„è¯ï¼ŒsetState å°±ä¸ä¼šåŒæ­¥æ›´æ–° this.stateï¼Œè€Œæ˜¯æ”¾åˆ°æ›´æ–°é˜Ÿåˆ—é‡Œé¢åç»­æ›´æ–°ã€‚

        è¿™æ ·ä½ å°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆåŸç”Ÿäº‹ä»¶å’Œ setTimeout/setinterval é‡Œé¢è°ƒç”¨ this.state ä¼šåŒæ­¥æ›´æ–°äº†å§ï¼Œå› ä¸ºé€šè¿‡è¿™äº›å‡½æ•°è°ƒç”¨çš„ React æ²¡åŠæ³•å»è°ƒç”¨ batchedUpdate å‡½æ•°å°† isBatchingUpdates è®¾ç½®ä¸º trueï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ setState çš„æ—¶å€™é»˜è®¤å°±æ˜¯ falseï¼Œé‚£ä¹ˆå°±ä¼šåŒæ­¥æ›´æ–°ã€‚

        æœ€å setState æ˜¯ React éå¸¸é‡è¦çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå€¼å¾—å¤§å®¶å¥½å¥½å»ç ”ç©¶ä¸€ä¸‹ä»–çš„åŸç†ã€‚

  33ã€é‡æ„ä»£ç éœ€è¦è€ƒè™‘çš„é—®é¢˜æœ‰å“ªäº›ï¼Ÿ
        ä»£ç è§„èŒƒï¼Œç»Ÿä¸€ï¼šæé«˜å¯ç†è§£æ€§
        ä»£ç æ¶æ„ï¼šé™ä½ä¿®æ”¹æˆæœ¬
        æ€§èƒ½ç“¶é¢ˆ

  34ã€çˆ¶ç»„ä»¶æ€ä¹ˆè·å–å­ç»„ä»¶çš„æ–¹æ³•
      çˆ¶ç»„ä»¶ï¼š
        class Father extends Component {
          onRef = (ref) => {
            this.content = ref
          }

          handleClick = () => {
            this.content.update()
          }

          render() {
            return (
              <div>
                <button onClick={this.handleClick}></button>
                <Child onRef={this.onRef} />
              </div>
            )
          }
        }

       å­ç»„ä»¶ï¼š
        class Child extends Component {
          componentDidMounted() {
            this.props.onRef(this)
          }
          update() {
            console.log('update...')
          }
        }

    35ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨redux+immutableï¼Œreduxå’Œå…¨å±€å˜é‡çš„åŒºåˆ«

    36ã€react-reduxçš„å·¥ä½œåŸç†å’Œç›¸å…³æºç 

    37ã€setStateçš„æ‰¹é‡æ›´æ–°çš„é—®é¢˜
        setState æœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ä½œå‚æ•°ã€‚ç¬¬äºŒç§æ–¹æ³•æ˜¯ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œå‚æ•°ã€‚
        ä½ çŸ¥é“è¿™ä¸¤ç§æ–¹æ³•åˆ†åˆ«åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å—ï¼Ÿ
        ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªå¯ä»¥å¯ç”¨æˆ–ç¦ç”¨çš„æŒ‰é’®ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šæœ‰ä¸€ä¸ªåä¸º isDisabled çš„çŠ¶æ€ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå¸ƒå°”å€¼ã€‚
        å¦‚æœä½ æƒ³åˆ‡æ¢è¿™ä¸ªæŒ‰é’®çš„çŠ¶æ€ï¼Œä½ å¯èƒ½å¾ˆä¼šå†™è¿™æ ·çš„ä¸€æ®µä»£ç ï¼š
        // setState ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ä½œå‚æ•°
        this.setState({ isDisabled: !this.state.isDisabled })

        é‚£ä¹ˆï¼Œè¿™æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿé—®é¢˜åœ¨äº React çŠ¶æ€æ›´æ–°å¯ä»¥æ‰¹å¤„ç†ï¼ˆbatchUpdateï¼‰ï¼Œè¿™æ„å‘³ç€å¤šä¸ªçŠ¶æ€æ›´æ–°å¯ä»¥åœ¨ä¸€ä¸ªæ›´æ–°å‘¨æœŸä¸­å‘ç”Ÿã€‚å¦‚æœä½ çš„æ›´æ–°å°†è¢«æ‰¹å¤„ç†ï¼Œå¹¶ä¸”ä½ å¯¹ isDisabled çŠ¶æ€æœ‰å¤šä¸ªæ›´æ–°ï¼Œé‚£ä¹ˆæœ€ç»ˆç»“æœå¯èƒ½ä¸æ˜¯ä½ æ‰€æœŸæœ›çš„ã€‚
        æ›´æ–°çŠ¶æ€çš„æ›´æ­£ç¡®çš„æ–¹æ³•æ˜¯æä¾›å‰ä¸€ä¸ªçŠ¶æ€çš„å‡½æ•°ä½œä¸ºå‚æ•°:
        this.setState(prevState => ({ isDisabled: !prevState.isDisabled }))

        ç°åœ¨ï¼Œå³ä½¿ä½ çš„çŠ¶æ€æ›´æ–°è¢«æ‰¹å¤„ç†ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæ›´æ–°éƒ½åœ¨æ“ä½œ isDisabled çŠ¶æ€ï¼Œä½†æ¯ä¸ªæ›´æ–°éƒ½ä¾èµ–äºæ­£ç¡®çš„å…ˆå‰çŠ¶æ€ï¼Œå› æ­¤ä½ æ€»æ˜¯ä¼šå¾—åˆ°é¢„æœŸçš„ç»“æœã€‚

        ç±»ä¼¼çš„é€’å¢è®¡æ•°å™¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚
        // ä¸è¦è¿™æ ·åš
        this.setState({ counterValue: this.state.counterValue + 1 })
        // æ­£ç¡®çš„å†™æ³•
        this.setState(prevState => ({ counterValue: prevState.counterValue + 1 }))

    38ã€å‰ç«¯ç›‘æ§sentry
        https://docs.sentry.io/platforms/javascript/react/

        import * as Sentry from '@sentry/react';
        Sentry.init({dsn: "http://73c2b3e82a96434ba7c9dc3d92f123de@sentry.yunduoketang.com/6"});

        http://sentry.yunduoketang.com/sentry/react-91/issues/49/?query=is%3Aunresolved
        xucong@yuuxin.com 12345

    39ã€åˆ©ç”¨useMemoå®ç°ç±»ä¼¼computedçš„åŠŸèƒ½
    

*/

    export default {
        
    }
</script>

<style lang="scss" scoped>

</style>